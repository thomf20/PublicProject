@page
@model PublicProject.Pages.IndexModel
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@{
    ViewData["Title"] = "Startsida";
    var user = await UserManager.GetUserAsync(User);
}


<html class="home blog no-js" lang="en-US">
<head>
    <title>Itsy | A cutesy little template by FreeHTML5.co</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          type="text/css" media="all" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Amatic+SC%3A400%2C700%7CLato%3A400%2C700%2C400italic%2C700italic&amp;ver=4.9.8"
          type="text/css" media="screen" />
    <link rel="stylesheet" href="css/Itsy/style.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="css/Itsy/print.css" type="text/css" media="print" />
    <!--[if (lt IE 9) & (!IEMobile)]>
    <link rel="stylesheet" id="lt-ie9-css" href="ie.css" type="text/css" media="screen"/>
    <![endif]-->
    <script src='js/jquery-3.0.0.min.js'></script>
    <script src='js/jquery-migrate-3.0.1.min.js'></script>
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="home sticky-menu sidebar-off"id="top">
    @if (SignInManager.IsSignedIn(User))
    {
        var hasUsername = Model.ScopedData.UserProfiles.FirstOrDefault(n => n.UserId == user.Id);

        <a asp-page="/overview" asp-route-id="@user.Id"><h3 class="home-sticky-title"> Min användarprofil</h3></a>

        if (hasUsername?.UserName == null)
        {
            <p style="color: red">Var vänlig och gå över till <a href="~/overview">UserProfile</a> för att registrera ett användarnamn för att börja blogga!</p>
        }
    }

    <div class="hero" style="background-image: url('images/lead.jpg'); text-align:right;">
        <div class="hero-inner">
            <div class="inner">
                <h1><span class="border border-top border-bottom"> Snackis</span></h1>
                <div class="hero-line-one"></div>
                <div class="hero-line-two"><span class="border border-bottom"><a  style="color:#FFF;">av Elias, Thom & Mohammed</a></span></div>
            </div>

            <a class="more-arrow" href="#content"><i class="fa fa-chevron-down"></i><span>Scroll Down</span></a>

        </div>
    </div>
     <br />

    <div class="home-sticky" id="content">
        <a asp-page="/Topicbrowser"><h2 class="home-sticky-title">Bläddra bland ämnen</h2></a>

        @{
            Model.ScopedData.Blogs.Reverse();
            var mostPopular = Model.ScopedData.Blogs.OrderByDescending(x => x.Popularity).ToList();
        }
        <div class="recent-posts">
            <h2>Senaste foruminlägg</h2><br />
        <div class="row">
            @for (int i = 0; i <= 2; i++)
            {
                <div class="col-md-4">
                    <div class="card m-2">
                        <div class="card-body">
                            <h5 class="card-title">@Model.ScopedData.Blogs[i].Title</h5>
                                <img src="~/img/@Model.ScopedData.Blogs[i].Image" class="card-image">
                                <p class="card-text">@Extensions.Extensions.LimitLength(Model.ScopedData.Blogs[i].Text, 150)...</p>
                        </div>
                        <p class="card-footer">@Model.ScopedData.Blogs[i].Date</p>
                        <div class="text-center">
                            <a class="btn btn-primary" asp-page="/ViewForumPost" asp-route-id="@Model.ScopedData.Blogs[i].Id">Se inlägg</a>
                        </div>
                    </div>
                </div>
            }
        </div>
        </div>

    <div class="footer-widgets widget-count-4">
        <div class="wrap">
            <div class="widget footer">
                <h4>Populäraste inläggen</h4>
                <ul>
                    @for (int i = 0; i < 3; i++)
                    {
                        <li>
                                <a asp-page="/ViewForumPost" asp-route-id="@mostPopular[i].Id">@mostPopular[i].Title</a>
                        </li>
                    }
                </ul>
            </div>
            <div class="mt-about-you-widget">

                <div class="widget footer">

                    <h4>Snackis</h4>

                    <div class="mt-about-bio">
                        <p>
                            Den här hemsidan är skapad av Elias, Thom och Mohammed
                        </p>
                    </div>
                </div>
            </div>
            <div class="widget footer">
                @if (SignInManager.IsSignedIn(User))
                {
                    var inAdminRole = User.IsInRole("Admin");
                    if (inAdminRole == true)
                    {
                        <h4>Admin</h4>
                        <div class="textwidget">
                            <ul>
                                <li>
                                    <a href="~/reports">Rapporterade kommentarer</a>
                                </li>
                                <li>
                                    <a href="~/admin/categoryadmin">Skapa kategori</a>
                                </li>
                                <li>
                                    <a href="~/admin/subcategory">Skapa sub-kategori</a>
                                </li>
@*                                <li>
                                    <a href="">More admin stuff</a>
                                </li>   *@                                                    
                            </ul>
                        </div>
                    }
                    else
                    {
                        <h4>Skapad av oss</h4>
                        <div class="textwidget">
                            <ul>
                                <li>
                                    <a href="https://www.linkedin.com/in/mohammed-karimi-40b7551a9/">Mohammed</a>
                                </li>
                                <li>
                                    <a href="https://www.linkedin.com/in/thom-flodqvist-025256262/">Thom</a>
                                </li>
                                <li>
                                    <a href="https://www.linkedin.com/in/elias-zanghnaeh-25900824a/">Elias</a>
                                </li>
                            </ul>
                        </div>
                    }
                }
                else
                {
                        <h4>Gjord av oss</h4>
                    <div class="textwidget">
                        <ul>
                            <li>
                                <a href="https://www.linkedin.com/in/mohammed-karimi-40b7551a9/">Mohammed</a>
                            </li>
                            <li>
                                <a href="https://www.linkedin.com/in/thom-flodqvist-025256262/">Thom</a>
                            </li>
                            <li>
                                <a href="https://www.linkedin.com/in/elias-zanghnaeh-25900824a/">Elias</a>
                            </li>
                        </ul>
                    </div>
                }
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-wrap">
            <div id="footer-text">
                &copy; 2023 - Snackis - <a asp-area="" asp-page="/Privacy">Integritet</a>
            </div>
            <a href="#top" id="btt">Top <i class="fa fa-chevron-up"></i></a>
        </div>
    </footer>

    <script>var ie9 = false;</script>
    <script src="js/global-plugins.min.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
